 Una de las principales decisiones que debemos tomar al momento de resolver un problema de Machine Learning es elegir el modelo más adecuado para los datos que estemos procesando. Es decir que el objetivo es encontrar el modelo que una vez entrenado genera las mejores predicciones posibles. Así que en este video les voy a mostrar la serie de pasos que sugiero para seleccionar el modelo más adecuado para nuestro problema de Machine Learning. Pero antes de comenzar los invito a visitar codificandovids.com Es donde encontrarán la Academia Online concursos de Inteligencia Artificial, Ciencia de Datos y Machine Learning que les permitirán construir su carrera en estas áreas y todo por una suscripción mensual de tan solo 10 dólares. Así que listo, comencemos. Antes de ver este paso a paso es importante hacer algunas aclaraciones. En primer lugar cuando digo el mejor modelo me estoy refiriendo a que el modelo que genere las mejores predicciones. Es decir que no vamos a tener en cuenta por ejemplo situaciones en las cuales queremos que el modelo genere las predicciones lo más rápido posible. Es decir con el menor tiempo de cómputo o aquel modelo que ocupe el menor espacio en memoria. En segundo lugar es importante que tengan claros varios conceptos que hemos visto en videos anteriores pero que resultan fundamentales para lo que vamos a ver a continuación en este proceso paso a paso para la selección del modelo. Así que les sugiero ver esos videos, pero a continuación voy a hacer un breve resumen de los principales conceptos. El primero de ellos son los parámetros e hiperparámetros de un modelo. Los parámetros de un modelo son las variables numéricas internas que el modelo aprende con el algoritmo de entrenamiento. Mientras que los hiperparámetros son las variables numéricas externas que nosotros debemos fijar al momento de programar dicho algoritmo. Por otra parte existe algo que se conoce como la afinación de hiperparámetros que nos permite encontrar los valores más adecuados que deben tener los hiperparámetros para lograr generar las mejores predicciones posibles. Y tanto para entrenar el modelo como para ajustar sus hiperparámetros y evaluar su desempeño, podemos usar dos enfoques. La partición del set de datos en los sets de entrenamiento, validación y prueba o usando lo que se conoce como la validación cruzada. Entonces con estas aclaraciones iniciales ya estamos listos para entender cómo realizar la selección del modelo. Así que comencemos entendiendo cuál es el problema que queremos resolver. Supongamos que queremos resolver este problema hipotético, digamos que queremos predecir la eficiencia en el consumo de gasolina de un vehículo, es decir la cantidad de litros de gasolina que consume por cada kilómetro recorrido. Y esta eficiencia en el consumo es simplemente un número, esto quiere decir que por ejemplo si tenemos una eficiencia de 0.5 litros por kilómetro, esto quiere decir que si el vehículo recorre un kilómetro, en promedio requerirá un consumo de medio litro de gasolina. Y supongamos además que esta eficiencia depende de variables como el tamaño del motor del vehículo en centímetros cúbicos, su potencia medida en caballos de potencia, su peso en kilogramos, así como el número de cilindros y la edad misma del vehículo. Así que el objetivo es construir un modelo de Machine Learning que tome estas variables numéricas de entrada y que aprenda a la salida a generar una predicción del valor que tendría la eficiencia en el consumo. Esto se conoce como una tarea de regresión, que quiere decir que el modelo debe aprender a predecir una cantidad numérica. Y la idea es que esta predicción sea lo más cercana posible al valor real de la eficiencia del consumo. Así que con este panorama ahora sí podemos ver el procedimiento paso a paso para seleccionar el mejor modelo para este problema en particular. La idea básica de la selección del mejor modelo consiste en entrenar múltiples modelos, luego evaluar el desempeño de cada uno de ellos usando el set de datos y finalmente elegir aquel modelo que genere las mejores predicciones. Y el primer paso es establecer lo que se conoce como la métrica de desempeño que usaremos para comparar los diferentes modelos. Esta métrica de desempeño es simplemente una fórmula matemática que a la salida nos arrojará un número que nos permitirá evaluar que también o mal lo está haciendo el modelo al momento de generar predicciones. Y esta fórmula lo que hace en esencia es comparar las predicciones que hace el modelo con los valores de referencia, es decir que en este caso lo que va a hacer es comparar el valor predicho para esa eficiencia en el consumo de combustible con el valor real. Y la fórmula o métrica que escojamos dependerá del tipo de problema que queramos resolver. Así que en este caso como tenemos un problema de regresión tendremos a nuestra disposición diferentes métricas de las cuales voy a hablar más adelante en otro video, pero en nuestro caso podemos escoger lo que se conoce como la raíz cuadrada del error cuadrático medio o RMSE por sus siglas en inglés. Para entender en qué consiste este RMSE, supongamos que tenemos 200 datos de prueba para verificar el desempeño del modelo que estamos construyendo. Y supongamos que ingresamos al modelo entrenado cada uno de estos 200 datos generando 200 predicciones. Pero además por cada uno de estos datos tendremos el valor real de la eficiencia en el consumo. Así que en últimas tendremos 200 predicciones y 200 valores reales de eficiencia. Entonces para obtener el RMSE debemos hacer estos cálculos. Primero obtenemos las diferencias entre el valor real y el valor predicho para cada dato y las elevamos al cuadrado. Luego sumamos estas diferencias al cuadrado y dividimos el resultado entre el número total de datos que estamos comparando, que son 200 en este caso. Y finalmente obtenemos la raíz cuadrada de este resultado. La lógica de elevar al cuadrado cada diferencia es para evitar que al hacer la suma se anulen mutuamente errores individuales. Lo que podría llevar a la obtención de errores aparentemente más pequeños de lo que realmente son. Además al dividir la suma de estas diferencias cuadráticas entre el número total de datos, lo que estamos es calculando el valor promedio de estas diferencias. Y finalmente al obtener la raíz cuadrada estamos garantizando que el resultado final tendrá las mismas unidades originales de cada una de las variables que estamos comparando. Que en este caso será la eficiencia del consumo medida en litros por kilómetro. Por ejemplo si al hacer este cálculo para un modelo determinado encontramos que el RMSE es de 0.1 litros por kilómetro, quiere decir que en promedio para dicho modelo las predicciones se alejarán del valor real aproximadamente 0.1 litros por kilómetro. Esto quiere decir que entre más pequeño sea el valor del RMSE para un modelo en particular, mejores serán las predicciones generadas. Ahora el segundo paso es determinar qué tipos de modelos pueden resultar más adecuados para el problema que queremos resolver. Y esto es un desafío en sí mismo, pues elegir los modelos candidatos entre una amplia variedad de opciones requiere que tengamos experiencia y conocimiento en el uso de diferentes algoritmos y modelos de Machine Learning. Como guía les sugiero un video que encontrarán acá en el canal en donde hago un tour por las principales familias de algoritmos y modelos que existen para que tengan una idea general de los criterios a tener en cuenta para esta elección. Supongamos que consideramos tres opciones para este caso en particular. Una máquina de soporte vectorial, un bosque aleatorio y una red neuronal. Aunque podríamos elegir más, en este ejemplo nos centraremos solo en estas tres arquitecturas de las cuales ya habló en videos anteriores. En este punto no podemos decir con antelación cuál de estos modelos resultará más adecuado. Pues para ello debemos entrenarlos y medir su desempeño, que es precisamente el siguiente paso. Bien, en este tercer paso lo que tenemos que hacer es tomar cada uno de los modelos, entrenarlo, es decir encontrar sus parámetros, afinarlo, es decir encontrar el set de hiperparámetros que genera las mejores predicciones y luego validarlo, es decir calcular su RMSE. Y para lograr esto podemos usar los sets de entrenamiento, validación y prueba o la validación cruzada y al final de todo este procedimiento lo que tendremos será un número, el RMSE de cada modelo que nos indicará qué tan buenas predicciones está generando cada uno de estos modelos con datos que nunca había visto. Así que supongamos que nos enfocamos en el primer modelo, la máquina de soporte vectorial. Tomamos el set de datos original, entrenamos el modelo, ajustamos sus hiperparámetros y tras este procedimiento lo validamos y obtenemos un RMSE de por ejemplo 0.23 litros por kilómetro. Ahora vamos al segundo modelo que es el bosque aleatorio y supongamos que tras entrenarlo, afinarlo y calcular su error de validación obtenemos un RMSE de 0.26 litros por kilómetro. Y finalmente repetimos el mismo procedimiento para el tercer modelo, la red neuronal. La entrenamos y ajustamos sus hiperparámetros y luego la validamos, obteniendo un RMSE de 0.19 litros por kilómetro. Y después de este procedimiento ya tenemos tres diferentes modelos entrenados y para cada uno hemos obtenido el set de hiperparámetros que genera las mejores predicciones y además hemos medido su desempeño. Así que solo nos resta el último paso, seleccionar el mejor modelo. ¿Qué es el mejor modelo? Recordemos que cuando nos referimos al mejor modelo estamos hablando de aquel modelo que genere las mejores predicciones posibles y recordemos precisamente que el RMSE es un número que nos indica que tan buenas predicciones está generando cada uno de los modelos. Entonces volviendo al paso anterior recordemos que al final de cada validación obtuvimos valores de 0.23 litros por kilómetro para la máquina de soporte vectorial, 0.26 litros por kilómetro para el bosque aleatorio y 0.19 litros por kilómetro para la red neuronal. Así que solo nos resta decidir con base en este desempeño cuál de los tres modelos es el mejor. Y para ello recordemos que el RMSE mide en últimas el error promedio que tendrá la predicción hecha por cada modelo. Así que entre más pequeño sea el RMSE mejores serán las predicciones generadas por el modelo. Entonces en este caso en particular el mejor modelo será aquel con el menor RMSE que corresponde a la red neuronal que en promedio genera un error de 0.19 litros por kilómetro al momento de predecir la eficiencia en el consumo de combustible. Y listo en este punto y siguiendo los pasos que les acabo de mencionar ya habremos seleccionado el modelo que genera las mejores predicciones para el problema que estamos resolviendo. Muy bien, acabamos de ver en qué consiste el proceso de selección del mejor modelo de Machine Learning para resolver un problema usando como único criterio el desempeño al momento de hacer las predicciones. Y este procedimiento es bastante simple, comenzamos eligiendo la métrica de desempeño después seleccionamos las posibles arquitecturas o tipos de modelos más adecuados luego entrenamos, afinamos y validamos cada modelo y al final elegimos aquel modelo con la mejor métrica de desempeño. Sin embargo, cuando tenemos otras restricciones adicionales como el tiempo de cómputo al momento de hacer las predicciones o el tamaño en memoria que pueda ocupar el modelo pues ya tendremos que considerar esos elementos adicionales al momento de seleccionar el mejor modelo. Si tienen alguna duda de lo que les acabo de comentar no olviden dejarla abajo en los comentarios y si les gustó el vídeo no olviden darle un pulgar hacia arriba de me gusta y compartirlo con sus amigos y conocidos pues esto me ayudará a llevar este contenido cada vez a más y más personas. Y desde luego si aún no lo han hecho los invito a suscribirse al canal y activar la campanita para que YouTube les notifique cada vez que publique nuevo contenido. Por ahora esto es todo, les envío un saludo y nos vemos en el próximo vídeo.
